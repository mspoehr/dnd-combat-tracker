(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{100:function(e,t,n){},102:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(13),i=n.n(c),u=n(28),d=n(15),o=n(20),s=n(60),l=n.n(s),j=Object(o.b)({selectId:function(e){return e.uuid},sortComparer:function(e,t){return l()(e.name,t.name,{caseInsensitive:!0})}}),x=Object(o.c)({name:"encounters",initialState:j.getInitialState,reducers:{addEncounter:j.addOne,removeEncounter:j.removeOne}}),b=x.actions,O=(b.addEncounter,b.removeEncounter,j.getSelectors((function(e){return e.encounters})).selectAll),h=x.reducer,v=Object(o.b)({selectId:function(e){return e.uuid},sortComparer:function(e,t){return l()(e.name,t.name,{caseInsensitive:!0})}}),p=Object(o.c)({name:"monsters",initialState:v.getInitialState,reducers:{addMonster:v.addOne,removeMonster:v.removeOne}}),m=p.actions,f=(m.addMonster,m.removeMonster,p.reducer),y=n(27),g=n(2),C=n(59),N=n(118),k={creatures:[],currentTurn:0,round:0};function I(e){e.sort((function(e,t){var n=t.initiative-e.initiative;return 0===n?e.order-t.order:n})),function(e){var t=0,n=null;e.forEach((function(e){e.initiative!==n?(n=e.initiative,t=0):t++,e.order=t}))}(e)}function T(e,t){return(t+e.currentTurn)%e.creatures.length}var H=Object(o.c)({name:"initiativeTracker",initialState:k,reducers:{addCreatures:function(e,t){var n,r,a=null===(n=e.creatures[e.currentTurn])||void 0===n?void 0:n.uuid,c=t.payload.map((function(e,t){return Object(g.a)({order:t,uuid:Object(N.a)()},e)}));(r=e.creatures).push.apply(r,Object(y.a)(c)),I(e.creatures),e.creatures.length>1&&(0!==e.currentTurn||0!==e.round)&&(e.currentTurn=e.creatures.findIndex((function(e){return e.uuid===a})))},deleteCreature:function(e,t){var n,r=null===(n=e.creatures[e.currentTurn])||void 0===n?void 0:n.uuid,a=T(e,t.payload);if(e.creatures.splice(a,1),e.creatures.length>1&&(0!==e.currentTurn||0!==e.round)){var c=e.creatures.findIndex((function(e){return e.uuid===r}));-1!==c&&(e.currentTurn=c)}},editCreature:function(e,t){var n=T(e,t.payload.index);e.creatures[n]=Object(g.a)(Object(g.a)({},e.creatures[n]),t.payload.creature),I(e.creatures)},previous:function(e){e.currentTurn--,-1===e.currentTurn&&e.round>0&&(e.round-=1,e.currentTurn=e.creatures.length-1),e.currentTurn<0&&(e.currentTurn=0),e.round<0&&(e.round=0)},next:function(e){e.currentTurn=(e.currentTurn+1)%Math.max(e.creatures.length,1),0===e.currentTurn&&(e.round+=1)},changeInitiative:function(e,t){var n=t.payload.newInitiative;if(!isNaN(Number(n))||""===n){var r=T(e,t.payload.index);e.creatures[r].initiative=""===n?0:Number(n),I(e.creatures)}},rollAllInitiative:function(e){e.creatures.forEach((function(t){if("monster"===t.type){t.initiative=Math.floor(20*Math.random()+1),I(e.creatures)}}))},adjustCreatureHealth:function(e,t){var n,r,a,c=T(e,t.payload.index),i=e.creatures[c].currentHp+t.payload.amount;e.creatures[c].currentHp=(n=i,r=0,a=e.creatures[c].maxHp,Math.min(Math.max(n,r),a))},reorderCreature:function(e,t){var n=T(e,t.payload.index),r=T(e,t.payload.newIndex);e.creatures[n].initiative=e.creatures[r].initiative,e.creatures[n].order=e.creatures[r].order+(n<r?1:-1),I(e.creatures)},restartEncounter:function(e){e.currentTurn=0,e.round=0,e.creatures.forEach((function(e){e.currentHp=e.maxHp}))},clearEncounter:function(){return JSON.parse(JSON.stringify(k))}}}),S=H.actions,w=S.addCreatures,M=S.deleteCreature,A=S.editCreature,E=S.changeInitiative,q=S.next,R=S.previous,z=S.adjustCreatureHealth,J=S.rollAllInitiative,P=S.reorderCreature,Q=S.restartEncounter,G=S.clearEncounter,L=function(e){return e.initiativeTracker.currentTurn},B=function(e){return e.initiativeTracker.round},D=Object(C.a)((function(e){return e.initiativeTracker.creatures}),L,(function(e,t){return e.slice(t).concat(e.slice(0,t))})),F=H.reducer,U={creatures:[{name:"",ac:0,maxHp:0,initiative:0,type:"monster",quantity:1}],modalOpen:!1,editingMode:!1,editIndex:0},V=Object(o.c)({name:"quickAdd",initialState:U,reducers:{changeName:function(e,t){e.creatures[t.payload.index].name=t.payload.name},changeAc:function(e,t){isNaN(t.payload.ac)||(e.creatures[t.payload.index].ac=t.payload.ac)},changeMaxHp:function(e,t){isNaN(t.payload.maxHp)||(e.creatures[t.payload.index].maxHp=t.payload.maxHp)},changeInitiative:function(e,t){isNaN(t.payload.initiative)||(e.creatures[t.payload.index].initiative=t.payload.initiative)},changeType:function(e,t){e.creatures[t.payload.index].type=t.payload.type},changeQuantity:function(e,t){isNaN(t.payload.quantity)||(e.creatures[t.payload.index].quantity=t.payload.quantity)},open:function(e){e.modalOpen=!0},close:function(){return JSON.parse(JSON.stringify(U))},addRow:function(e){e.creatures.push({name:"",ac:0,maxHp:0,initiative:0,type:"monster",quantity:1})},edit:function(e,t){var n,r,a,c,i;e.editingMode=!0,e.creatures=[{name:null!==(n=t.payload.creature.name)&&void 0!==n?n:"",ac:null!==(r=t.payload.creature.ac)&&void 0!==r?r:0,maxHp:null!==(a=t.payload.creature.maxHp)&&void 0!==a?a:0,initiative:null!==(c=t.payload.creature.initiative)&&void 0!==c?c:0,quantity:0,type:null!==(i=t.payload.creature.type)&&void 0!==i?i:"monster"}],e.modalOpen=!0,e.editIndex=t.payload.index}}}),W=V.actions,K=W.changeName,X=W.changeAc,Y=W.changeMaxHp,Z=W.changeInitiative,$=W.changeQuantity,_=W.open,ee=W.close,te=W.edit,ne=W.changeType,re=W.addRow,ae=function(e){return e.quickAdd.creatures},ce=function(e){return e.quickAdd.editingMode},ie=function(e){return e.quickAdd.editIndex},ue=function(e){return e.quickAdd.modalOpen},de=V.reducer,oe=Object(d.c)({encounters:h,monsters:f,initiativeTracker:F,quickAdd:de}),se=Object(o.a)({reducer:oe,preloadedState:function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}()});se.subscribe((function(){try{var e=se.getState();localStorage.setItem("state",JSON.stringify(e))}catch(t){console.log("Couldn't save the app state!")}}));var le=function(){return Object(u.c)()},je=u.d,xe=n(49),be=n(8),Oe=n(1),he=function(){return Object(Oe.jsx)("div",{children:Object(Oe.jsx)(be.b,{})})},ve=function(){return Object(Oe.jsx)("div",{children:"This is where you will go to edit an encounter!"})},pe=n(109),me=n(110),fe=n(111),ye=n(83),ge=n(120),Ce=n(65);function Ne(){return Object(Oe.jsx)(pe.a,{variant:"info",children:"There are no encounters yet. Create one now!"})}function ke(){var e=je(O),t=e.map((function(e){return Object(Oe.jsx)("div",{children:e.name},e.uuid)}));return Object(Oe.jsx)("div",{children:0===e.length?Object(Oe.jsx)(Ne,{}):t})}var Ie=function(){return Object(Oe.jsx)("div",{children:Object(Oe.jsxs)(me.a,{fluid:!0,className:"my-3",children:[Object(Oe.jsxs)(fe.a,{children:[Object(Oe.jsx)(ye.a,{children:Object(Oe.jsx)("h1",{children:"My Encounters"})}),Object(Oe.jsx)(ye.a,{md:"auto",children:Object(Oe.jsxs)(ge.a,{direction:"horizontal",gap:2,children:[Object(Oe.jsx)(xe.b,{to:"/encounters/quick/run",children:Object(Oe.jsx)(Ce.a,{variant:"outline-primary",children:"Quick Run Encounter"})}),Object(Oe.jsx)(Ce.a,{variant:"primary",onClick:function(){return alert("Not implemented yet!")},children:"Add Encounter"})]})})]}),Object(Oe.jsx)(fe.a,{children:Object(Oe.jsx)(ke,{})})]})})},Te=function(){return Object(Oe.jsx)("div",{children:"This is a list of all my monsters:"})},He=n(115),Se=n(85),we=n(117),Me=n(7),Ae=n(112),Ee=n(113),qe=n(114),Re=n(116);function ze(e){var t=le();return Object(Oe.jsxs)(fe.a,{children:[Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(we.a.Group,{className:"mv-3",children:[Object(Oe.jsx)(we.a.Label,{children:"Name"}),Object(Oe.jsx)(Ae.a,{hasValidation:!0,children:Object(Oe.jsx)(we.a.Control,{isInvalid:e.validated&&""===e.currentCreature.name,value:e.currentCreature.name,onChange:function(n){t(K({name:n.target.value,index:e.index}))},type:"text"})})]})}),Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(we.a.Group,{className:"mv-3",children:[Object(Oe.jsx)(we.a.Label,{children:"Armor Class"}),Object(Oe.jsx)(we.a.Control,{value:e.currentCreature.ac,onChange:function(n){t(X({ac:Number(n.target.value),index:e.index}))},type:"text"})]})}),Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(we.a.Group,{className:"mv-3",children:[Object(Oe.jsx)(we.a.Label,{children:"Max HP"}),Object(Oe.jsx)(we.a.Control,{value:e.currentCreature.maxHp,onChange:function(n){t(Y({maxHp:Number(n.target.value),index:e.index}))},type:"text"})]})}),Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(we.a.Group,{className:"mv-3",children:[Object(Oe.jsx)(we.a.Label,{children:"Initiative"}),Object(Oe.jsx)(we.a.Control,{value:e.currentCreature.initiative,onChange:function(n){t(Z({initiative:Number(n.target.value),index:e.index}))},type:"text"})]})}),!e.editMode&&Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(we.a.Group,{className:"mv-3",children:[Object(Oe.jsx)(we.a.Label,{children:"Quantity"}),Object(Oe.jsx)(we.a.Control,{value:e.currentCreature.quantity,onChange:function(n){t($({quantity:Number(n.target.value),index:e.index}))},type:"text"})]})}),Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(we.a.Group,{className:"mv-3",children:[Object(Oe.jsx)(we.a.Label,{children:"Creature Type"}),Object(Oe.jsx)(Ee.a,{children:[{name:"Player",value:"player"},{name:"Monster",value:"monster"}].map((function(n,r){return Object(Oe.jsx)(qe.a,{id:"radio-".concat(e.index,"-").concat(r),type:"radio",variant:r%2?"outline-danger":"outline-success",name:"radio-".concat(e.index),value:n.value,checked:e.currentCreature.type===n.value,onChange:function(n){return t(ne({type:n.currentTarget.value,index:e.index}))},children:n.name},r)}))})]})})]})}var Je=function(){var e=je(ae),t=le(),n=je(ie),a=je(ce),c=Object(r.useState)(!1),i=Object(Me.a)(c,2),u=i[0],d=i[1];return Object(Oe.jsx)(we.a,{children:Object(Oe.jsxs)(Re.a,{size:"lg",show:je(ue),onHide:function(){return t(ee())},centered:!0,children:[Object(Oe.jsx)(Re.a.Header,{closeButton:!0,children:Object(Oe.jsx)(Re.a.Title,{children:"Quick Add Creature"})}),Object(Oe.jsx)(Re.a.Body,{children:Object(Oe.jsxs)(we.a,{children:[e.map((function(e,t){return Object(Oe.jsx)(ze,{currentCreature:e,editMode:a,validated:u,index:t},t)})),!a&&Object(Oe.jsx)(Ce.a,{className:"my-2",variant:"primary",onClick:function(){return t(re())},children:"Add Row"})]})}),Object(Oe.jsxs)(Re.a.Footer,{children:[Object(Oe.jsx)(Ce.a,{variant:"secondary",onClick:function(){return t(ee())},children:"Close"}),Object(Oe.jsx)(Ce.a,{variant:"primary",onClick:function(){d(!0);var r=e.filter((function(e){return!(""===e.name&&0===e.ac&&0===e.maxHp&&0===e.initiative&&1===e.quantity)}));if(r.reduce((function(e,t){return e&&""!==t.name}),!0)){var c=r.map((function(e){return Object(g.a)(Object(g.a)({},e),{},{currentHp:e.maxHp})})).map((function(e){return new Array(e.quantity).fill(e)})).flat();t(a?A({index:n,creature:e[0]}):w(c)),t(ee())}},children:"Save Changes"})]})]})})},Pe=(n(98),n(119)),Qe=n(86),Ge=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(!1),a=Object(Me.a)(n,2),c=a[0],i=a[1],u=Object(r.useState)("0"),d=Object(Me.a)(u,2),o=d[0],s=d[1],l=le(),j=function(){s("0"),i(!1)};return Object(Oe.jsxs)(Oe.Fragment,{children:[Object(Oe.jsxs)("div",{ref:t,onClick:function(){return i(!0)},style:{minWidth:"110px"},children:[Object(Oe.jsx)("div",{children:"HP"}),Object(Oe.jsxs)("div",{className:"flex-row align-items-center",children:[Object(Oe.jsx)("div",{className:"bg-white p-2 rounded d-inline-block",children:e.creature.currentHp}),Object(Oe.jsx)("span",{className:"mx-2",children:"/"}),Object(Oe.jsx)("span",{children:e.creature.maxHp})]})]}),Object(Oe.jsx)(Pe.a,{rootClose:!0,target:t.current,show:c,placement:"right",onHide:j,children:Object(Oe.jsx)(Qe.a,{children:Object(Oe.jsxs)(ge.a,{direction:"vertical",gap:2,children:[Object(Oe.jsx)(Ce.a,{variant:"success",onClick:function(){l(z({index:e.index,amount:Number(o)})),j()},children:"Heal"}),Object(Oe.jsx)(we.a.Control,{value:o,type:"text",onChange:function(e){return t=e.target.value,void(isNaN(Number(t))&&""!==t||s(""===t?"":t));var t}}),Object(Oe.jsx)(Ce.a,{variant:"danger",onClick:function(){l(z({index:e.index,amount:-Number(o)})),j()},children:"Damage"})]})})})]})},Le=n(79);function Be(e){var t,n=le();return Object(Oe.jsxs)("div",{className:"initiative-creature",children:[Object(Oe.jsx)("div",{children:Object(Oe.jsxs)("div",{children:[Object(Oe.jsx)("div",{children:"INITIATIVE"}),Object(Oe.jsx)(we.a.Control,{type:"text",value:null!==(t=e.creature.initiative)&&void 0!==t?t:"",style:{width:"100px"},className:"text-center",onChange:function(t){return n(E({index:e.index,newInitiative:t.target.value}))}})]})}),Object(Oe.jsxs)("div",{className:"flex-grow-1 text-start",children:[Object(Oe.jsx)("div",{className:"fw-bold",style:{fontSize:"1.5em"},children:e.creature.name}),Object(Oe.jsxs)("div",{children:["AC ",e.creature.ac]}),Object(Oe.jsxs)(ge.a,{direction:"horizontal",gap:2,children:[Object(Oe.jsx)(Ce.a,{onClick:function(){return n(te({index:e.index,creature:e.creature}))},children:"Edit"}),Object(Oe.jsx)(Ce.a,{variant:"danger",onClick:function(){return n(M(e.index))},children:"Delete"})]})]}),Object(Oe.jsx)("div",{children:Object(Oe.jsx)(Ge,{index:e.index,creature:e.creature})})]})}var De=function(){var e=je(D),t=le();return Object(Oe.jsxs)("div",{children:[Object(Oe.jsxs)(ge.a,{className:"my-2",direction:"horizontal",gap:2,children:[Object(Oe.jsx)(Ce.a,{onClick:function(){return t(_())},children:"Quick Add Creature"}),Object(Oe.jsx)(Ce.a,{onClick:function(){return t(J())},children:"Roll Initiative"})]}),Object(Oe.jsx)(Je,{}),Object(Oe.jsx)("div",{children:Object(Oe.jsx)(Le.a,{onDragEnd:function(e){e.destination&&t(P({index:e.source.index,newIndex:e.destination.index}))},children:Object(Oe.jsx)(Le.c,{droppableId:"droppable",children:function(t){return Object(Oe.jsxs)("div",Object(g.a)(Object(g.a)({},t.droppableProps),{},{ref:t.innerRef,children:[e.map((function(e,t){return Object(Oe.jsx)(Le.b,{draggableId:e.uuid,index:t,children:function(n,r){return Object(Oe.jsx)("div",Object(g.a)(Object(g.a)(Object(g.a)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{style:(a=r.isDragging,c=n.draggableProps.style,Object(g.a)(Object(g.a)({userSelect:"none",marginBottom:"1rem"},c),{},{opacity:a?.5:1})),children:Object(Oe.jsx)(Be,{creature:e,index:t},e.uuid)}));var a,c}},e.uuid)})),t.placeholder]}))}})})})]})};function Fe(e){return Object(Oe.jsxs)("div",{className:"text-center fw-bold",children:[Object(Oe.jsx)("div",{children:e.text}),Object(Oe.jsx)("div",{style:{fontSize:"1.5em"},children:e.value+1})]})}function Ue(){var e=je(L),t=je(B),n=le();return Object(Oe.jsx)(me.a,{fluid:!0,className:"p-2 mb-4",style:{borderBottom:"2px solid black"},children:Object(Oe.jsxs)(fe.a,{className:"align-items-center",children:[Object(Oe.jsx)(ye.a,{children:Object(Oe.jsx)("h1",{className:"fw-bold",children:"Quick Encounter"})}),Object(Oe.jsx)(ye.a,{children:Object(Oe.jsxs)(ge.a,{direction:"horizontal",gap:4,children:[Object(Oe.jsx)(Fe,{text:"ROUND",value:t}),Object(Oe.jsx)(Fe,{text:"TURN",value:e})]})}),Object(Oe.jsx)(ye.a,{md:"auto",children:Object(Oe.jsxs)(ge.a,{direction:"horizontal",gap:2,children:[Object(Oe.jsx)(Ce.a,{variant:"outline-primary",onClick:function(){return n(R())},children:"Previous turn"}),Object(Oe.jsx)(Ce.a,{onClick:function(){return n(q())},children:"Next turn"}),Object(Oe.jsxs)(He.a,{title:"More",variant:"secondary",children:[Object(Oe.jsx)(Se.a.Item,{as:"button",onClick:function(){return n(Q())},children:"Restart encounter"}),Object(Oe.jsx)(Se.a.Item,{as:"button",onClick:function(){return n(G())},children:"Clear initiative order"})]})]})})]})})}var Ve=function(){return Object(Oe.jsxs)("div",{children:[Object(Oe.jsx)(Ue,{}),Object(Oe.jsx)(De,{})]})},We=(n(99),function(){return Object(Oe.jsx)(xe.a,{children:Object(Oe.jsx)(be.e,{children:Object(Oe.jsxs)(be.c,{path:"/",element:Object(Oe.jsx)(he,{}),children:[Object(Oe.jsxs)(be.c,{path:"encounters",children:[Object(Oe.jsx)(be.c,{index:!0,element:Object(Oe.jsx)(be.a,{replace:!0,to:"/"})}),Object(Oe.jsxs)(be.c,{path:":id",children:[Object(Oe.jsx)(be.c,{index:!0,element:Object(Oe.jsx)(ve,{})}),Object(Oe.jsx)(be.c,{path:"run",element:Object(Oe.jsx)(Ve,{})})]})]}),Object(Oe.jsx)(be.c,{path:"monsters",element:Object(Oe.jsx)(Te,{})}),Object(Oe.jsx)(be.c,{index:!0,element:Object(Oe.jsx)(Ie,{})})]})})})});n(100),n(101);i.a.render(Object(Oe.jsx)(a.a.StrictMode,{children:Object(Oe.jsx)(u.a,{store:se,children:Object(Oe.jsx)(We,{})})}),document.getElementById("root"))},98:function(e,t,n){},99:function(e,t,n){}},[[102,1,2]]]);
//# sourceMappingURL=main.287db0de.chunk.js.map