(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(11),i=n.n(a),u=n(23),o=n(12),d=n(18),s=n(45),l=n.n(s),j=Object(d.b)({selectId:function(e){return e.uuid},sortComparer:function(e,t){return l()(e.name,t.name,{caseInsensitive:!0})}}),x=Object(d.c)({name:"encounters",initialState:j.getInitialState,reducers:{addEncounter:j.addOne,removeEncounter:j.removeOne}}),b=x.actions,O=(b.addEncounter,b.removeEncounter,j.getSelectors((function(e){return e.encounters})).selectAll),h=x.reducer,v=Object(d.b)({selectId:function(e){return e.uuid},sortComparer:function(e,t){return l()(e.name,t.name,{caseInsensitive:!0})}}),m=Object(d.c)({name:"monsters",initialState:v.getInitialState,reducers:{addMonster:v.addOne,removeMonster:v.removeOne}}),p=m.actions,f=(p.addMonster,p.removeMonster,m.reducer),g=n(2),y=n(44),C=n(96);function N(e){e.sort((function(e,t){var n=t.initiative-e.initiative;return 0===n?e.order-t.order:n})),function(e){var t=0,n=null;e.forEach((function(e){e.initiative!==n?(n=e.initiative,t=0):t++,e.order=t}))}(e)}function T(e,t){return(t+e.currentTurn)%e.creatures.length}var k=Object(d.c)({name:"initiativeTracker",initialState:{creatures:[],currentTurn:0,round:0},reducers:{addCreature:function(e,t){var n,r=null===(n=e.creatures[e.currentTurn])||void 0===n?void 0:n.uuid,c=Object(g.a)({order:0,uuid:Object(C.a)()},t.payload);e.creatures.push(c),N(e.creatures),e.creatures.length>1&&(0!==e.currentTurn||0!==e.round)&&(e.currentTurn=e.creatures.findIndex((function(e){return e.uuid===r})))},deleteCreature:function(e,t){var n,r=null===(n=e.creatures[e.currentTurn])||void 0===n?void 0:n.uuid,c=T(e,t.payload);if(e.creatures.splice(c,1),e.creatures.length>1&&(0!==e.currentTurn||0!==e.round)){var a=e.creatures.findIndex((function(e){return e.uuid===r}));-1!==a&&(e.currentTurn=a)}},editCreature:function(e,t){var n=T(e,t.payload.index);e.creatures[n]=Object(g.a)(Object(g.a)({},e.creatures[n]),t.payload.creature),N(e.creatures)},previous:function(e){e.currentTurn--,-1===e.currentTurn&&e.round>0&&(e.round-=1,e.currentTurn=e.creatures.length-1),e.currentTurn<0&&(e.currentTurn=0),e.round<0&&(e.round=0)},next:function(e){e.currentTurn=(e.currentTurn+1)%Math.max(e.creatures.length,1),0===e.currentTurn&&(e.round+=1)},changeInitiative:function(e,t){var n=t.payload.newInitiative;if(!isNaN(Number(n))||""===n){var r=T(e,t.payload.index);e.creatures[r].initiative=""===n?0:Number(n),N(e.creatures)}},rollAllInitiative:function(e){e.creatures.forEach((function(t){if("monster"===t.type){t.initiative=Math.floor(20*Math.random()+1),N(e.creatures)}}))},adjustCreatureHealth:function(e,t){var n,r,c,a=T(e,t.payload.index),i=e.creatures[a].currentHp+t.payload.amount;e.creatures[a].currentHp=(n=i,r=0,c=e.creatures[a].maxHp,Math.min(Math.max(n,r),c))},reorderCreature:function(e,t){var n=T(e,t.payload.index),r=T(e,t.payload.newIndex);e.creatures[n].initiative=e.creatures[r].initiative,e.creatures[n].order=e.creatures[r].order+(n<r?1:-1),N(e.creatures)}}}),I=k.actions,A=I.addCreature,H=I.deleteCreature,S=I.editCreature,w=I.changeInitiative,M=I.next,E=I.previous,q=I.adjustCreatureHealth,z=I.rollAllInitiative,P=I.reorderCreature,F=function(e){return e.initiativeTracker.currentTurn},R=function(e){return e.initiativeTracker.round},J=Object(y.a)((function(e){return e.initiativeTracker.creatures}),F,(function(e,t){return e.slice(t).concat(e.slice(0,t))})),B=k.reducer,D={name:"",ac:0,maxHp:0,initiative:0,type:"monster",modalOpen:!1,editingMode:!1,editIndex:0},G=Object(d.c)({name:"quickAdd",initialState:D,reducers:{changeName:function(e,t){e.name=t.payload},changeAc:function(e,t){isNaN(t.payload)||(e.ac=t.payload)},changeMaxHp:function(e,t){isNaN(t.payload)||(e.maxHp=t.payload)},changeInitiative:function(e,t){isNaN(t.payload)||(e.initiative=t.payload)},changeType:function(e,t){e.type=t.payload},open:function(e){e.modalOpen=!0},close:function(){return JSON.parse(JSON.stringify(D))},edit:function(e,t){var n,r,c,a,i;e.editingMode=!0,e.name=null!==(n=t.payload.creature.name)&&void 0!==n?n:"",e.ac=null!==(r=t.payload.creature.ac)&&void 0!==r?r:0,e.maxHp=null!==(c=t.payload.creature.maxHp)&&void 0!==c?c:0,e.initiative=null!==(a=t.payload.creature.initiative)&&void 0!==a?a:0,e.modalOpen=!0,e.editIndex=t.payload.index,e.type=null!==(i=t.payload.creature.type)&&void 0!==i?i:"monster"}}}),L=G.actions,Q=L.changeName,U=L.changeAc,V=L.changeMaxHp,W=L.changeInitiative,K=L.open,X=L.close,Y=L.edit,Z=L.changeType,$=function(e){return e.quickAdd.name},_=function(e){return e.quickAdd.ac},ee=function(e){return e.quickAdd.maxHp},te=function(e){return e.quickAdd.initiative},ne=function(e){return e.quickAdd.modalOpen},re=function(e){return e.quickAdd.editingMode},ce=function(e){return e.quickAdd.editIndex},ae=function(e){return e.quickAdd.type},ie=G.reducer,ue=Object(o.c)({encounters:h,monsters:f,initiativeTracker:B,quickAdd:ie}),oe=Object(d.a)({reducer:ue,preloadedState:function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}()});oe.subscribe((function(){try{var e=oe.getState();localStorage.setItem("state",JSON.stringify(e))}catch(t){console.log("Couldn't save the app state!")}}));var de=function(){return Object(u.c)()},se=u.d,le=n(35),je=n(7),xe=n(1),be=function(){return Object(xe.jsx)("div",{children:Object(xe.jsx)(je.b,{})})},Oe=function(){return Object(xe.jsx)("div",{children:"This is where you will go to edit an encounter!"})},he=n(94),ve=n(88),me=n(89),pe=n(63),fe=n(97),ge=n(64);function ye(){return Object(xe.jsx)(he.a,{variant:"info",children:"There are no encounters yet. Create one now!"})}function Ce(){var e=se(O),t=e.map((function(e){return Object(xe.jsx)("div",{children:e.name},e.uuid)}));return Object(xe.jsx)("div",{children:0===e.length?Object(xe.jsx)(ye,{}):t})}var Ne=function(){return Object(xe.jsx)("div",{children:Object(xe.jsxs)(ve.a,{fluid:!0,className:"my-3",children:[Object(xe.jsxs)(me.a,{children:[Object(xe.jsx)(pe.a,{children:Object(xe.jsx)("h1",{children:"My Encounters"})}),Object(xe.jsx)(pe.a,{md:"auto",children:Object(xe.jsxs)(fe.a,{direction:"horizontal",gap:2,children:[Object(xe.jsx)(le.b,{to:"/encounters/quick/run",children:Object(xe.jsx)(ge.a,{variant:"outline-primary",children:"Quick Run Encounter"})}),Object(xe.jsx)(ge.a,{variant:"primary",onClick:function(){return alert("Not implemented yet!")},children:"Add Encounter"})]})})]}),Object(xe.jsx)(me.a,{children:Object(xe.jsx)(Ce,{})})]})})},Te=function(){return Object(xe.jsx)("div",{children:"This is a list of all my monsters:"})},ke=n(95),Ie=n(93),Ae=n(90),He=n(91),Se=function(){var e=se($),t=se(_),n=se(ee),r=se(te),c=se(re),a=se(ce),i=se(ae),u=de();return Object(xe.jsxs)(Ie.a,{size:"lg",show:se(ne),onHide:function(){return u(X())},centered:!0,children:[Object(xe.jsx)(Ie.a.Header,{closeButton:!0,children:Object(xe.jsx)(Ie.a.Title,{children:"Quick Add Creature"})}),Object(xe.jsx)(Ie.a.Body,{children:Object(xe.jsx)(ke.a,{children:Object(xe.jsxs)(me.a,{children:[Object(xe.jsx)(pe.a,{children:Object(xe.jsxs)(ke.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(xe.jsx)(ke.a.Label,{children:"Name"}),Object(xe.jsx)(ke.a.Control,{value:e,onChange:function(e){u(Q(e.target.value))},type:"text"})]})}),Object(xe.jsx)(pe.a,{children:Object(xe.jsxs)(ke.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(xe.jsx)(ke.a.Label,{children:"Armor Class"}),Object(xe.jsx)(ke.a.Control,{value:t,onChange:function(e){u(U(Number(e.target.value)))},type:"text"})]})}),Object(xe.jsx)(pe.a,{children:Object(xe.jsxs)(ke.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(xe.jsx)(ke.a.Label,{children:"Max HP(Optional)"}),Object(xe.jsx)(ke.a.Control,{value:n,onChange:function(e){u(V(Number(e.target.value)))},type:"text"})]})}),Object(xe.jsx)(pe.a,{children:Object(xe.jsxs)(ke.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(xe.jsx)(ke.a.Label,{children:"Initiative(Optional)"}),Object(xe.jsx)(ke.a.Control,{value:r,onChange:function(e){u(W(Number(e.target.value)))},type:"text"})]})}),Object(xe.jsx)(pe.a,{children:Object(xe.jsxs)(ke.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(xe.jsx)(ke.a.Label,{children:"Creature Type"}),Object(xe.jsx)(Ae.a,{children:[{name:"Player",value:"player"},{name:"Monster",value:"monster"}].map((function(e,t){return Object(xe.jsx)(He.a,{id:"radio-".concat(t),type:"radio",variant:t%2?"outline-danger":"outline-success",name:"radio",value:e.value,checked:i===e.value,onChange:function(e){return u(Z(e.currentTarget.value))},children:e.name},t)}))})]})})]})})}),Object(xe.jsxs)(Ie.a.Footer,{children:[Object(xe.jsx)(ge.a,{variant:"secondary",onClick:function(){return u(X())},children:"Close"}),Object(xe.jsx)(ge.a,{variant:"primary",onClick:function(){var o={name:e,ac:t,maxHp:n,initiative:r,currentHp:n,type:i};u(c?S({index:a,creature:o}):A(o)),u(X())},children:"Save Changes"})]})]})},we=(n(78),n(8)),Me=n(92),Ee=n(66),qe=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(!1),c=Object(we.a)(n,2),a=c[0],i=c[1],u=Object(r.useState)("0"),o=Object(we.a)(u,2),d=o[0],s=o[1],l=de(),j=function(){s("0"),i(!1)};return Object(xe.jsxs)(xe.Fragment,{children:[Object(xe.jsxs)("div",{ref:t,onClick:function(){return i(!0)},style:{minWidth:"110px"},children:[Object(xe.jsx)("div",{children:"HP"}),Object(xe.jsxs)("div",{className:"flex-row align-items-center",children:[Object(xe.jsx)("div",{className:"bg-white p-2 rounded d-inline-block",children:e.creature.currentHp}),Object(xe.jsx)("span",{className:"mx-2",children:"/"}),Object(xe.jsx)("span",{children:e.creature.maxHp})]})]}),Object(xe.jsx)(Me.a,{rootClose:!0,target:t.current,show:a,placement:"right",onHide:j,children:Object(xe.jsx)(Ee.a,{children:Object(xe.jsxs)(fe.a,{direction:"vertical",gap:2,children:[Object(xe.jsx)(ge.a,{variant:"success",onClick:function(){l(q({index:e.index,amount:Number(d)})),j()},children:"Heal"}),Object(xe.jsx)(ke.a.Control,{value:d,type:"text",onChange:function(e){return t=e.target.value,void(isNaN(Number(t))&&""!==t||s(""===t?"":t));var t}}),Object(xe.jsx)(ge.a,{variant:"danger",onClick:function(){l(q({index:e.index,amount:-Number(d)})),j()},children:"Damage"})]})})})]})},ze=n(57);function Pe(e){var t,n=de();return Object(xe.jsxs)("div",{className:"initiative-creature",children:[Object(xe.jsx)("div",{children:Object(xe.jsxs)("div",{children:[Object(xe.jsx)("div",{children:"INITIATIVE"}),Object(xe.jsx)(ke.a.Control,{type:"text",value:null!==(t=e.creature.initiative)&&void 0!==t?t:"",style:{width:"100px"},className:"text-center",onChange:function(t){return n(w({index:e.index,newInitiative:t.target.value}))}})]})}),Object(xe.jsxs)("div",{className:"flex-grow-1 text-start",children:[Object(xe.jsx)("div",{className:"fw-bold",style:{fontSize:"1.5em"},children:e.creature.name}),Object(xe.jsxs)("div",{children:["AC ",e.creature.ac]}),Object(xe.jsxs)(fe.a,{direction:"horizontal",gap:2,children:[Object(xe.jsx)(ge.a,{onClick:function(){return n(Y({index:e.index,creature:e.creature}))},children:"Edit"}),Object(xe.jsx)(ge.a,{variant:"danger",onClick:function(){return n(H(e.index))},children:"Delete"})]})]}),Object(xe.jsx)("div",{children:Object(xe.jsx)(qe,{index:e.index,creature:e.creature})})]})}var Fe=function(){var e=se(J),t=de();return Object(xe.jsxs)("div",{children:[Object(xe.jsxs)(fe.a,{direction:"horizontal",gap:2,children:[Object(xe.jsx)(ge.a,{onClick:function(){return t(K())},children:"Quick Add Creature"}),Object(xe.jsx)(ge.a,{onClick:function(){return t(z())},children:"Roll Initiative"})]}),Object(xe.jsx)(Se,{}),Object(xe.jsx)("div",{children:Object(xe.jsx)(ze.a,{onDragEnd:function(e){e.destination&&t(P({index:e.source.index,newIndex:e.destination.index}))},children:Object(xe.jsx)(ze.c,{droppableId:"droppable",children:function(t){return Object(xe.jsxs)("div",Object(g.a)(Object(g.a)({},t.droppableProps),{},{ref:t.innerRef,children:[e.map((function(e,t){return Object(xe.jsx)(ze.b,{draggableId:e.uuid,index:t,children:function(n,r){return Object(xe.jsx)("div",Object(g.a)(Object(g.a)(Object(g.a)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{style:(c=r.isDragging,a=n.draggableProps.style,Object(g.a)(Object(g.a)({userSelect:"none",marginBottom:"1rem"},a),{},{opacity:c?.5:1})),children:Object(xe.jsx)(Pe,{creature:e,index:t},e.uuid)}));var c,a}},e.uuid)})),t.placeholder]}))}})})})]})};function Re(e){return Object(xe.jsxs)("div",{className:"text-center fw-bold",children:[Object(xe.jsx)("div",{children:e.text}),Object(xe.jsx)("div",{style:{fontSize:"1.5em"},children:e.value+1})]})}function Je(){var e=se(F),t=se(R),n=de();return Object(xe.jsx)(ve.a,{fluid:!0,className:"p-2 mb-4",style:{borderBottom:"2px solid black"},children:Object(xe.jsxs)(me.a,{className:"align-items-center",children:[Object(xe.jsx)(pe.a,{children:Object(xe.jsx)("h1",{className:"fw-bold",children:"Quick Encounter"})}),Object(xe.jsx)(pe.a,{children:Object(xe.jsxs)(fe.a,{direction:"horizontal",gap:4,children:[Object(xe.jsx)(Re,{text:"ROUND",value:t}),Object(xe.jsx)(Re,{text:"TURN",value:e})]})}),Object(xe.jsx)(pe.a,{md:"auto",children:Object(xe.jsxs)(fe.a,{direction:"horizontal",gap:2,children:[Object(xe.jsx)(ge.a,{variant:"outline-primary",onClick:function(){return n(E())},children:"Previous turn"}),Object(xe.jsx)(ge.a,{onClick:function(){return n(M())},children:"Next turn"})]})})]})})}var Be=function(){return Object(xe.jsxs)("div",{children:[Object(xe.jsx)(Je,{}),Object(xe.jsx)(Fe,{})]})},De=(n(79),function(){return Object(xe.jsx)(le.a,{children:Object(xe.jsx)(je.e,{children:Object(xe.jsxs)(je.c,{path:"/",element:Object(xe.jsx)(be,{}),children:[Object(xe.jsxs)(je.c,{path:"encounters",children:[Object(xe.jsx)(je.c,{index:!0,element:Object(xe.jsx)(je.a,{replace:!0,to:"/"})}),Object(xe.jsxs)(je.c,{path:":id",children:[Object(xe.jsx)(je.c,{index:!0,element:Object(xe.jsx)(Oe,{})}),Object(xe.jsx)(je.c,{path:"run",element:Object(xe.jsx)(Be,{})})]})]}),Object(xe.jsx)(je.c,{path:"monsters",element:Object(xe.jsx)(Te,{})}),Object(xe.jsx)(je.c,{index:!0,element:Object(xe.jsx)(Ne,{})})]})})})});n(80),n(81);i.a.render(Object(xe.jsx)(c.a.StrictMode,{children:Object(xe.jsx)(u.a,{store:oe,children:Object(xe.jsx)(De,{})})}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.2770d37f.chunk.js.map