(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(12),i=n.n(a),u=n(26),o=n(14),d=n(19),s=n(58),l=n.n(s),j=Object(d.b)({selectId:function(e){return e.uuid},sortComparer:function(e,t){return l()(e.name,t.name,{caseInsensitive:!0})}}),x=Object(d.c)({name:"encounters",initialState:j.getInitialState,reducers:{addEncounter:j.addOne,removeEncounter:j.removeOne}}),b=x.actions,O=(b.addEncounter,b.removeEncounter,j.getSelectors((function(e){return e.encounters})).selectAll),h=x.reducer,v=Object(d.b)({selectId:function(e){return e.uuid},sortComparer:function(e,t){return l()(e.name,t.name,{caseInsensitive:!0})}}),m=Object(d.c)({name:"monsters",initialState:v.getInitialState,reducers:{addMonster:v.addOne,removeMonster:v.removeOne}}),p=m.actions,f=(p.addMonster,p.removeMonster,m.reducer),g=n(2),y=n(57),C=n(115),N={creatures:[],currentTurn:0,round:0};function k(e){e.sort((function(e,t){var n=t.initiative-e.initiative;return 0===n?e.order-t.order:n})),function(e){var t=0,n=null;e.forEach((function(e){e.initiative!==n?(n=e.initiative,t=0):t++,e.order=t}))}(e)}function I(e,t){return(t+e.currentTurn)%e.creatures.length}var T=Object(d.c)({name:"initiativeTracker",initialState:N,reducers:{addCreature:function(e,t){var n,r=null===(n=e.creatures[e.currentTurn])||void 0===n?void 0:n.uuid,c=Object(g.a)({order:0,uuid:Object(C.a)()},t.payload);e.creatures.push(c),k(e.creatures),e.creatures.length>1&&(0!==e.currentTurn||0!==e.round)&&(e.currentTurn=e.creatures.findIndex((function(e){return e.uuid===r})))},deleteCreature:function(e,t){var n,r=null===(n=e.creatures[e.currentTurn])||void 0===n?void 0:n.uuid,c=I(e,t.payload);if(e.creatures.splice(c,1),e.creatures.length>1&&(0!==e.currentTurn||0!==e.round)){var a=e.creatures.findIndex((function(e){return e.uuid===r}));-1!==a&&(e.currentTurn=a)}},editCreature:function(e,t){var n=I(e,t.payload.index);e.creatures[n]=Object(g.a)(Object(g.a)({},e.creatures[n]),t.payload.creature),k(e.creatures)},previous:function(e){e.currentTurn--,-1===e.currentTurn&&e.round>0&&(e.round-=1,e.currentTurn=e.creatures.length-1),e.currentTurn<0&&(e.currentTurn=0),e.round<0&&(e.round=0)},next:function(e){e.currentTurn=(e.currentTurn+1)%Math.max(e.creatures.length,1),0===e.currentTurn&&(e.round+=1)},changeInitiative:function(e,t){var n=t.payload.newInitiative;if(!isNaN(Number(n))||""===n){var r=I(e,t.payload.index);e.creatures[r].initiative=""===n?0:Number(n),k(e.creatures)}},rollAllInitiative:function(e){e.creatures.forEach((function(t){if("monster"===t.type){t.initiative=Math.floor(20*Math.random()+1),k(e.creatures)}}))},adjustCreatureHealth:function(e,t){var n,r,c,a=I(e,t.payload.index),i=e.creatures[a].currentHp+t.payload.amount;e.creatures[a].currentHp=(n=i,r=0,c=e.creatures[a].maxHp,Math.min(Math.max(n,r),c))},reorderCreature:function(e,t){var n=I(e,t.payload.index),r=I(e,t.payload.newIndex);e.creatures[n].initiative=e.creatures[r].initiative,e.creatures[n].order=e.creatures[r].order+(n<r?1:-1),k(e.creatures)},restartEncounter:function(e){e.currentTurn=0,e.round=0,e.creatures.forEach((function(e){e.currentHp=e.maxHp}))},clearEncounter:function(){return JSON.parse(JSON.stringify(N))}}}),A=T.actions,H=A.addCreature,S=A.deleteCreature,E=A.editCreature,M=A.changeInitiative,w=A.next,q=A.previous,z=A.adjustCreatureHealth,J=A.rollAllInitiative,P=A.reorderCreature,R=A.restartEncounter,F=A.clearEncounter,B=function(e){return e.initiativeTracker.currentTurn},D=function(e){return e.initiativeTracker.round},G=Object(y.a)((function(e){return e.initiativeTracker.creatures}),B,(function(e,t){return e.slice(t).concat(e.slice(0,t))})),L=T.reducer,Q={name:"",ac:0,maxHp:0,initiative:0,type:"monster",modalOpen:!1,editingMode:!1,editIndex:0},U=Object(d.c)({name:"quickAdd",initialState:Q,reducers:{changeName:function(e,t){e.name=t.payload},changeAc:function(e,t){isNaN(t.payload)||(e.ac=t.payload)},changeMaxHp:function(e,t){isNaN(t.payload)||(e.maxHp=t.payload)},changeInitiative:function(e,t){isNaN(t.payload)||(e.initiative=t.payload)},changeType:function(e,t){e.type=t.payload},open:function(e){e.modalOpen=!0},close:function(){return JSON.parse(JSON.stringify(Q))},edit:function(e,t){var n,r,c,a,i;e.editingMode=!0,e.name=null!==(n=t.payload.creature.name)&&void 0!==n?n:"",e.ac=null!==(r=t.payload.creature.ac)&&void 0!==r?r:0,e.maxHp=null!==(c=t.payload.creature.maxHp)&&void 0!==c?c:0,e.initiative=null!==(a=t.payload.creature.initiative)&&void 0!==a?a:0,e.modalOpen=!0,e.editIndex=t.payload.index,e.type=null!==(i=t.payload.creature.type)&&void 0!==i?i:"monster"}}}),V=U.actions,W=V.changeName,K=V.changeAc,X=V.changeMaxHp,Y=V.changeInitiative,Z=V.open,$=V.close,_=V.edit,ee=V.changeType,te=function(e){return e.quickAdd.name},ne=function(e){return e.quickAdd.ac},re=function(e){return e.quickAdd.maxHp},ce=function(e){return e.quickAdd.initiative},ae=function(e){return e.quickAdd.modalOpen},ie=function(e){return e.quickAdd.editingMode},ue=function(e){return e.quickAdd.editIndex},oe=function(e){return e.quickAdd.type},de=U.reducer,se=Object(o.c)({encounters:h,monsters:f,initiativeTracker:L,quickAdd:de}),le=Object(d.a)({reducer:se,preloadedState:function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}()});le.subscribe((function(){try{var e=le.getState();localStorage.setItem("state",JSON.stringify(e))}catch(t){console.log("Couldn't save the app state!")}}));var je=function(){return Object(u.c)()},xe=u.d,be=n(47),Oe=n(8),he=n(1),ve=function(){return Object(he.jsx)("div",{children:Object(he.jsx)(Oe.b,{})})},me=function(){return Object(he.jsx)("div",{children:"This is where you will go to edit an encounter!"})},pe=n(107),fe=n(108),ge=n(109),ye=n(81),Ce=n(117),Ne=n(63);function ke(){return Object(he.jsx)(pe.a,{variant:"info",children:"There are no encounters yet. Create one now!"})}function Ie(){var e=xe(O),t=e.map((function(e){return Object(he.jsx)("div",{children:e.name},e.uuid)}));return Object(he.jsx)("div",{children:0===e.length?Object(he.jsx)(ke,{}):t})}var Te=function(){return Object(he.jsx)("div",{children:Object(he.jsxs)(fe.a,{fluid:!0,className:"my-3",children:[Object(he.jsxs)(ge.a,{children:[Object(he.jsx)(ye.a,{children:Object(he.jsx)("h1",{children:"My Encounters"})}),Object(he.jsx)(ye.a,{md:"auto",children:Object(he.jsxs)(Ce.a,{direction:"horizontal",gap:2,children:[Object(he.jsx)(be.b,{to:"/encounters/quick/run",children:Object(he.jsx)(Ne.a,{variant:"outline-primary",children:"Quick Run Encounter"})}),Object(he.jsx)(Ne.a,{variant:"primary",onClick:function(){return alert("Not implemented yet!")},children:"Add Encounter"})]})})]}),Object(he.jsx)(ge.a,{children:Object(he.jsx)(Ie,{})})]})})},Ae=function(){return Object(he.jsx)("div",{children:"This is a list of all my monsters:"})},He=n(112),Se=n(83),Ee=n(114),Me=n(113),we=n(110),qe=n(111),ze=function(){var e=xe(te),t=xe(ne),n=xe(re),r=xe(ce),c=xe(ie),a=xe(ue),i=xe(oe),u=je();return Object(he.jsxs)(Me.a,{size:"lg",show:xe(ae),onHide:function(){return u($())},centered:!0,children:[Object(he.jsx)(Me.a.Header,{closeButton:!0,children:Object(he.jsx)(Me.a.Title,{children:"Quick Add Creature"})}),Object(he.jsx)(Me.a.Body,{children:Object(he.jsx)(Ee.a,{children:Object(he.jsxs)(ge.a,{children:[Object(he.jsx)(ye.a,{children:Object(he.jsxs)(Ee.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(he.jsx)(Ee.a.Label,{children:"Name"}),Object(he.jsx)(Ee.a.Control,{value:e,onChange:function(e){u(W(e.target.value))},type:"text"})]})}),Object(he.jsx)(ye.a,{children:Object(he.jsxs)(Ee.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(he.jsx)(Ee.a.Label,{children:"Armor Class"}),Object(he.jsx)(Ee.a.Control,{value:t,onChange:function(e){u(K(Number(e.target.value)))},type:"text"})]})}),Object(he.jsx)(ye.a,{children:Object(he.jsxs)(Ee.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(he.jsx)(Ee.a.Label,{children:"Max HP(Optional)"}),Object(he.jsx)(Ee.a.Control,{value:n,onChange:function(e){u(X(Number(e.target.value)))},type:"text"})]})}),Object(he.jsx)(ye.a,{children:Object(he.jsxs)(Ee.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(he.jsx)(Ee.a.Label,{children:"Initiative(Optional)"}),Object(he.jsx)(Ee.a.Control,{value:r,onChange:function(e){u(Y(Number(e.target.value)))},type:"text"})]})}),Object(he.jsx)(ye.a,{children:Object(he.jsxs)(Ee.a.Group,{className:"mv-3",controlId:"exampleForm.ControlTextArea1",children:[Object(he.jsx)(Ee.a.Label,{children:"Creature Type"}),Object(he.jsx)(we.a,{children:[{name:"Player",value:"player"},{name:"Monster",value:"monster"}].map((function(e,t){return Object(he.jsx)(qe.a,{id:"radio-".concat(t),type:"radio",variant:t%2?"outline-danger":"outline-success",name:"radio",value:e.value,checked:i===e.value,onChange:function(e){return u(ee(e.currentTarget.value))},children:e.name},t)}))})]})})]})})}),Object(he.jsxs)(Me.a.Footer,{children:[Object(he.jsx)(Ne.a,{variant:"secondary",onClick:function(){return u($())},children:"Close"}),Object(he.jsx)(Ne.a,{variant:"primary",onClick:function(){var o={name:e,ac:t,maxHp:n,initiative:r,currentHp:n,type:i};u(c?E({index:a,creature:o}):H(o)),u($())},children:"Save Changes"})]})]})},Je=(n(96),n(7)),Pe=n(116),Re=n(84),Fe=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(!1),c=Object(Je.a)(n,2),a=c[0],i=c[1],u=Object(r.useState)("0"),o=Object(Je.a)(u,2),d=o[0],s=o[1],l=je(),j=function(){s("0"),i(!1)};return Object(he.jsxs)(he.Fragment,{children:[Object(he.jsxs)("div",{ref:t,onClick:function(){return i(!0)},style:{minWidth:"110px"},children:[Object(he.jsx)("div",{children:"HP"}),Object(he.jsxs)("div",{className:"flex-row align-items-center",children:[Object(he.jsx)("div",{className:"bg-white p-2 rounded d-inline-block",children:e.creature.currentHp}),Object(he.jsx)("span",{className:"mx-2",children:"/"}),Object(he.jsx)("span",{children:e.creature.maxHp})]})]}),Object(he.jsx)(Pe.a,{rootClose:!0,target:t.current,show:a,placement:"right",onHide:j,children:Object(he.jsx)(Re.a,{children:Object(he.jsxs)(Ce.a,{direction:"vertical",gap:2,children:[Object(he.jsx)(Ne.a,{variant:"success",onClick:function(){l(z({index:e.index,amount:Number(d)})),j()},children:"Heal"}),Object(he.jsx)(Ee.a.Control,{value:d,type:"text",onChange:function(e){return t=e.target.value,void(isNaN(Number(t))&&""!==t||s(""===t?"":t));var t}}),Object(he.jsx)(Ne.a,{variant:"danger",onClick:function(){l(z({index:e.index,amount:-Number(d)})),j()},children:"Damage"})]})})})]})},Be=n(77);function De(e){var t,n=je();return Object(he.jsxs)("div",{className:"initiative-creature",children:[Object(he.jsx)("div",{children:Object(he.jsxs)("div",{children:[Object(he.jsx)("div",{children:"INITIATIVE"}),Object(he.jsx)(Ee.a.Control,{type:"text",value:null!==(t=e.creature.initiative)&&void 0!==t?t:"",style:{width:"100px"},className:"text-center",onChange:function(t){return n(M({index:e.index,newInitiative:t.target.value}))}})]})}),Object(he.jsxs)("div",{className:"flex-grow-1 text-start",children:[Object(he.jsx)("div",{className:"fw-bold",style:{fontSize:"1.5em"},children:e.creature.name}),Object(he.jsxs)("div",{children:["AC ",e.creature.ac]}),Object(he.jsxs)(Ce.a,{direction:"horizontal",gap:2,children:[Object(he.jsx)(Ne.a,{onClick:function(){return n(_({index:e.index,creature:e.creature}))},children:"Edit"}),Object(he.jsx)(Ne.a,{variant:"danger",onClick:function(){return n(S(e.index))},children:"Delete"})]})]}),Object(he.jsx)("div",{children:Object(he.jsx)(Fe,{index:e.index,creature:e.creature})})]})}var Ge=function(){var e=xe(G),t=je();return Object(he.jsxs)("div",{children:[Object(he.jsxs)(Ce.a,{direction:"horizontal",gap:2,children:[Object(he.jsx)(Ne.a,{onClick:function(){return t(Z())},children:"Quick Add Creature"}),Object(he.jsx)(Ne.a,{onClick:function(){return t(J())},children:"Roll Initiative"})]}),Object(he.jsx)(ze,{}),Object(he.jsx)("div",{children:Object(he.jsx)(Be.a,{onDragEnd:function(e){e.destination&&t(P({index:e.source.index,newIndex:e.destination.index}))},children:Object(he.jsx)(Be.c,{droppableId:"droppable",children:function(t){return Object(he.jsxs)("div",Object(g.a)(Object(g.a)({},t.droppableProps),{},{ref:t.innerRef,children:[e.map((function(e,t){return Object(he.jsx)(Be.b,{draggableId:e.uuid,index:t,children:function(n,r){return Object(he.jsx)("div",Object(g.a)(Object(g.a)(Object(g.a)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{style:(c=r.isDragging,a=n.draggableProps.style,Object(g.a)(Object(g.a)({userSelect:"none",marginBottom:"1rem"},a),{},{opacity:c?.5:1})),children:Object(he.jsx)(De,{creature:e,index:t},e.uuid)}));var c,a}},e.uuid)})),t.placeholder]}))}})})})]})};function Le(e){return Object(he.jsxs)("div",{className:"text-center fw-bold",children:[Object(he.jsx)("div",{children:e.text}),Object(he.jsx)("div",{style:{fontSize:"1.5em"},children:e.value+1})]})}function Qe(){var e=xe(B),t=xe(D),n=je();return Object(he.jsx)(fe.a,{fluid:!0,className:"p-2 mb-4",style:{borderBottom:"2px solid black"},children:Object(he.jsxs)(ge.a,{className:"align-items-center",children:[Object(he.jsx)(ye.a,{children:Object(he.jsx)("h1",{className:"fw-bold",children:"Quick Encounter"})}),Object(he.jsx)(ye.a,{children:Object(he.jsxs)(Ce.a,{direction:"horizontal",gap:4,children:[Object(he.jsx)(Le,{text:"ROUND",value:t}),Object(he.jsx)(Le,{text:"TURN",value:e})]})}),Object(he.jsx)(ye.a,{md:"auto",children:Object(he.jsxs)(Ce.a,{direction:"horizontal",gap:2,children:[Object(he.jsx)(Ne.a,{variant:"outline-primary",onClick:function(){return n(q())},children:"Previous turn"}),Object(he.jsx)(Ne.a,{onClick:function(){return n(w())},children:"Next turn"}),Object(he.jsxs)(He.a,{title:"More",variant:"secondary",children:[Object(he.jsx)(Se.a.Item,{as:"button",onClick:function(){return n(R())},children:"Restart encounter"}),Object(he.jsx)(Se.a.Item,{as:"button",onClick:function(){return n(F())},children:"Clear initiative order"})]})]})})]})})}var Ue=function(){return Object(he.jsxs)("div",{children:[Object(he.jsx)(Qe,{}),Object(he.jsx)(Ge,{})]})},Ve=(n(97),function(){return Object(he.jsx)(be.a,{children:Object(he.jsx)(Oe.e,{children:Object(he.jsxs)(Oe.c,{path:"/",element:Object(he.jsx)(ve,{}),children:[Object(he.jsxs)(Oe.c,{path:"encounters",children:[Object(he.jsx)(Oe.c,{index:!0,element:Object(he.jsx)(Oe.a,{replace:!0,to:"/"})}),Object(he.jsxs)(Oe.c,{path:":id",children:[Object(he.jsx)(Oe.c,{index:!0,element:Object(he.jsx)(me,{})}),Object(he.jsx)(Oe.c,{path:"run",element:Object(he.jsx)(Ue,{})})]})]}),Object(he.jsx)(Oe.c,{path:"monsters",element:Object(he.jsx)(Ae,{})}),Object(he.jsx)(Oe.c,{index:!0,element:Object(he.jsx)(Te,{})})]})})})});n(98),n(99);i.a.render(Object(he.jsx)(c.a.StrictMode,{children:Object(he.jsx)(u.a,{store:le,children:Object(he.jsx)(Ve,{})})}),document.getElementById("root"))},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.bd871241.chunk.js.map